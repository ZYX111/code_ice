<html>
    <head>
        <meta charset="utf-8">
        <title>测试</title>
    </head>
    <body>
        <p id="gg" onclick="fun()">1</p>
        <script>
            function fun(){
                var map=[
                [[1,1,1,1,1,1,1,1,1],
                 [1,1,1,1,1,1,1,1,1],
                 [1,1,1,1,1,1,1,1,1],
                 [1,1,1,1,1,1,1,1,1],
                 [1,1,1,1,1,1,1,1,1],
                 [1,1,1,1,1,1,1,1,1],
                 [1,1,1,1,1,1,1,1,1],
                 [1,1,1,1,1,1,1,1,1],
                 [1,1,1,1,1,1,1,1,1]],
                [[1,1,1,1,1,0,0,0,0],
                 [1,0,0,0,1,0,0,0,0],
                 [1,0,2,0,1,0,1,1,1],
                 [1,0,2,0,1,0,1,4,1],
                 [1,1,1,0,1,1,1,3,1],
                 [0,1,1,0,0,0,0,3,1],
                 [0,1,0,0,0,1,0,0,1],
                 [0,1,0,0,0,1,1,1,1],
                 [0,1,1,1,1,1,0,0,0]],/*Z*/
                [[1,1,1,1,1,0,0,0,0],
                 [1,0,0,0,1,0,0,0,0],
                 [1,0,0,0,1,0,1,1,1],
                 [1,0,0,0,1,0,1,0,1],
                 [1,1,1,0,1,1,1,0,1],
                 [0,1,1,0,0,0,0,0,1],
                 [0,1,0,0,0,1,0,0,1],
                 [0,1,0,0,0,1,1,1,1],
                 [0,1,1,1,1,1,0,0,0]],
                [[1,1,1,1,1,1,1,1,1],
                 [1,1,1,1,1,1,1,1,1],
                 [1,1,1,1,1,1,1,1,1],
                 [1,1,1,1,1,1,1,1,1],
                 [1,1,1,1,1,1,1,1,1],
                 [1,1,1,1,1,1,1,1,1],
                 [1,1,1,1,1,1,1,1,1],
                 [1,1,1,1,1,1,1,1,1],
                 [1,1,1,1,1,1,1,1,1]]];//0→空,1→墙,2→箱子,3→点,4→箱子在点上,9→人
                    var poi=new Array();
                    var dir=[{x:0,y:-1,z:0},{x:-1,y:0,z:0},{x:0,y:+1,z:0},{x:+1,y:0,z:0},{x:0,y:0,z:+1},{x:0,y:0,z:-1}];
                    for(var k=0;k<2;k++){
                        for(var i=0;i<9;i++){
                            for(var j=0;j<9;j++){
                                if(map[k][i][j]==3){
                                    poi.push(k);
                                    poi.push(i);
                                    poi.push(j);
                                }
                            }
                        }
                    }
                    if(poi.length==0){
                        return false;
                    }
                    var key=new Array();
                    var x_z=new Array();
                    var y_z=new Array();
                    var z_z=new Array();
                    for(var i=0;i<poi.length/3;i++){
                        if(F(1,2,2,0,poi[3*i],poi[3*i+1],poi[2*i+2])==true){
                            key.push('s');
                            var map=[
                                    [[1,1,1,1,1,1,1,1,1],
                                     [1,1,1,1,1,1,1,1,1],
                                     [1,1,1,1,1,1,1,1,1],
                                     [1,1,1,1,1,1,1,1,1],
                                     [1,1,1,1,1,1,1,1,1],
                                     [1,1,1,1,1,1,1,1,1],
                                     [1,1,1,1,1,1,1,1,1],
                                     [1,1,1,1,1,1,1,1,1],
                                     [1,1,1,1,1,1,1,1,1]],
                                    [[1,1,1,1,1,0,0,0,0],
                                     [1,0,0,0,1,0,0,0,0],
                                     [1,0,2,0,1,0,1,1,1],
                                     [1,0,2,0,1,0,1,4,1],
                                     [1,1,1,0,1,1,1,3,1],
                                     [0,1,1,0,0,0,0,3,1],
                                     [0,1,0,0,0,1,0,0,1],
                                     [0,1,0,0,0,1,1,1,1],
                                     [0,1,1,1,1,1,0,0,0]],/*Z*/
                                    [[1,1,1,1,1,0,0,0,0],
                                     [1,0,0,0,1,0,0,0,0],
                                     [1,0,0,0,1,0,1,1,1],
                                     [1,0,0,0,1,0,1,0,1],
                                     [1,1,1,0,1,1,1,0,1],
                                     [0,1,1,0,0,0,0,0,1],
                                     [0,1,0,0,0,1,0,0,1],
                                     [0,1,0,0,0,1,1,1,1],
                                     [0,1,1,1,1,1,0,0,0]],
                                    [[1,1,1,1,1,1,1,1,1],
                                     [1,1,1,1,1,1,1,1,1],
                                     [1,1,1,1,1,1,1,1,1],
                                     [1,1,1,1,1,1,1,1,1],
                                     [1,1,1,1,1,1,1,1,1],
                                     [1,1,1,1,1,1,1,1,1],
                                     [1,1,1,1,1,1,1,1,1],
                                     [1,1,1,1,1,1,1,1,1],
                                     [1,1,1,1,1,1,1,1,1]]];
                                     if(F(1,2,3,0,poi[(3*i+3)%6],poi[(3*i+4)%6],poi[(3*i+5)%6])==true){
                                break;
                            }
                            else{
                                for(var i=0;i<key.length;i++){
                                    key.pop();
                                    z_z.pop();
                                    x_z.pop();
                                    y_z.pop();
                                }
                            }
                        }
                    }
                    if(key.length!=0){
                        document.getElementById("gg").innerHTML=key.toString();
                        return key;
                    }
                    else{
                        return null;
                    }
                    function F(z,x,y,d,k,a,b){
                        z_z.push(z);
                        x_z.push(x);
                        y_z.push(y);
                        key.push(d);
                        for(;;){
                            z=z_z.pop();
                            x=x_z.pop();
                            y=y_z.pop();
                            d=key.pop();
                            while(d<6){
                                if((map[z+dir[d].z][x+dir[d].x][y+dir[d].y]==0||map[z+dir[d].z][x+dir[d].x][y+dir[d].y]==3)&&(map[z-dir[d].z][x-dir[d].x][y-dir[d].y]==0||map[z-dir[d].z][x-dir[d].x][y-dir[d].y]==3||map[z-dir[d].z][x-dir[d].x][y-dir[d].y]==-1)){
                                    z_z.push(z);
                                    x_z.push(x);
                                    y_z.push(y);
                                    key.push(d);
                                    map[z][x][y]=-1;
                                    z=z+dir[d].z;
                                    x=x+dir[d].x;
                                    y=y+dir[d].y;
                                    if(z==k&&x==a&&y==b){
                                        return true;
                                    }
                                    else{
                                        d=0;
                                    }
                                }
                                else{
                                    d++;
                                    if(d==6){
                                        map[z][x][y]=-1;
                                    }
                                }
                            }
                        }
                    }
                }
        </script>
    </body>
</html>